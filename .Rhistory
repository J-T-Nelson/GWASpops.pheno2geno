max(variantIntersectDegreeTable)
summary(variantIntersectDegreeTable)
uniIntersectingVariants[1:20]
uniIntersectingVariants <- unique(as.character(purrr::flatten(intersection_results)))
length(uniIntersectingVariants) # 277
uniIntersectingVariants[1:20]
sum(!(unique(above.4_variants) %in% uniIntersectingVariants))
length(unique(asso$SNPS))
length(unique(full_SNP_Annotations_GWASc_Ensembl$VariantID))
209455/249792
paste0(round(209455/249792, digits = 2)*100, '5')
paste0(round(209455/249792, digits = 4)*100, '%')
View(full_fst_fixed)
nrow(full_fst_fixed)
paste0(round(159271/209455, digits = 4)*100, '%')
View(EFO_term_mapping)
unique(EFO_term_mapping$`Parent term`)
nrow(diseaseFst_fixed)
unique(rownames(diseaseFst_fixed))
length(unique(rownames(diseaseFst_fixed)))
save(diseaseFst_fixed, file='./workingData/full_data_for_analysis/diseaseFst_fixed.rds')
paste0(round(36097/159271, digits = 4)*100, '%')
q99 <- quantile(allSNPfst_sum, 0.99)
q95 <- quantile(allSNPfst_sum, 0.95)
q90 <- quantile(allSNPfst_sum, 0.90)
# pch = point character, cex = character expand
plot(allSNPfst_sum, main = "All Fst Sums, All Population Pairs", ylab = "Sum of Variant Fst", xlab = "Index of Sample", pch = 20, cex = .7)
abline(h = q99, col = 'green', lwd = 2)
abline(h = q95, col = 'blue', lwd = 2)
abline(h = q90, col = 'red', lwd = 2)
text(-4000, y = q99, "1%", pos = 3, offset = .5, col = 'darkgreen')
text(-4000, y = q95, "5%", pos = 3, offset = .5, col = 'darkblue')
text(-4000, y = q90, "10%", pos = 3, offset = .5, col = 'darkred')
thousGenPops$Population_Abbreviation
View(L_diseaseFst_popsVSall_topSnps)
unique(above.4_variants) %in% uniIntersectingVariants
singlePop_above.4_vars <- above.4_variants[unique(above.4_variants) %in% uniIntersectingVariants]
unique(singlePop_above.4_vars)
singlePop_above.4_vars <- above.4_variants[!(unique(above.4_variants) %in% uniIntersectingVariants)]
unique(singlePop_above.4_vars)
length(uniIntersectingVariants) # 277
length(unique(singlePop_above.4_vars))
above.4_names[1]
View(above.4_names)
# saving important data struc
getwd()
save(above.4_names, file = './workingData/popsVSmetapop_topVariants/above4_names.rds')
uni.4_names <- unique(purrr::flatten(above.4_names))
View(uni.4_names)
uni.4_names <- unique(as.character(purrr::flatten(above.4_names)))
View(SNPanno_GWAS_ensembl)
colnames(SNPanno_GWAS_ensembl)
above.4_Table <- SNPanno_GWAS_ensembl[SNPanno_GWAS_ensembl$VariantID %in% uni.4_names,]
lapply(above.4_names, function(x){x})
binPopAbove.4_perVar <- lapply(above.4_names, function(x){x %in% uni.4_names})
binPopAbove.4_perVar <- lapply(above.4_names, function(x){as.numeric(x %in% uni.4_names)})
View(binPopAbove.4_perVar)
binPopAbove.4_perVar <- lapply(above.4_names, function(x){as.numeric(uni.4_names %in% x)})
View(binPopAbove.4_perVar)
binPopAbove.4_perVar[["ACB"]]
binPopAbove.4_perVar[["AFR"]]
binPopAbove.4_perVar[["AMR"]]
binPopAbove.4_perVar[["ASW"]]
binPopAbove.4_perVar[["BEB"]]
binPopAbove.4_perVar[["CHB"]]
binPopAbove.4_perVar[["CLM"]]
binPopAbove.4_perVar[["ESN"]]
binPopAbove.4_perVar[["FIN"]]
binPopAbove.4_perVar[["GWD"]]
binPopAbove.4_perVar[["MSL"]]
binPopAbove.4_perVar <- dplyr::bind_rows(binPopAbove.4_perVar)
View(binPopAbove.4_perVar)
binPopAbove.4_perVar <- lapply(above.4_names, function(x){as.numeric(uni.4_names %in% x)})
binPopAbove.4_perVar <- dplyr::bind_cols(binPopAbove.4_perVar)
View(binPopAbove.4_perVar)
View(allDiseaseSNPfst_topTables)
View(diseaseFst_popsVSall)
# generate Fst based table
fstPopAbove.4_perVar <- diseaseFst_popsVSall[rownames(diseaseFst_popsVSall) %in% uni.4_names, ]
View(fstPopAbove.4_perVar)
colnames(fstPopAbove.4_perVar)
colnames(fstPopAbove.4_perVar) <- gsub('ALL','',gsub('1000GENOMES:phase_3:ALL','',gsub('-X-','',colnames(fstPopAbove.4_perVar))))
View(fstPopAbove.4_perVar)
colnames(fstPopAbove.4_perVar) <- gsub('1000GENOMES:phase_3:','',gsub('1000GENOMES:phase_3:ALL','',gsub('-X-','',colnames(fstPopAbove.4_perVar))))
?prcomp
pca_1 <- prcomp(fstPopAbove.4_perVar)
View(pca_1)
pca_1[["x"]]
5^2
#proportion of variance explained
PVE <- (pca_1$sdev**2) / sum(pca_1$sdev**2)
PVE
# lots of variance explained in the first 2 considering what I saw in my reference video not above 75% though
PVE[1]+PVE[2]
plot(pca_1$x[1],pca_1$x[2])
View(fstPopAbove.4_perVar)
plot(PVE, rev(PVE))
plot(PVE, PVE)
pca_1$x[1]
pca_1$x
pca_1$x[1,]
pca_1$x[,1]
plot(pca_1$x[,1],pca_1$x[,2]) # oh shit... looks like we may need to transpose before doing PCA.. maybe we know nothing yet
# going to transpose the input and see what we get:
pca_1 <- prcomp(t(fstPopAbove.4_perVar))
pca_1 <- prcomp(fstPopAbove.4_perVar)
# going to transpose the input and see what we get:
pca_2 <- prcomp(t(fstPopAbove.4_perVar))
View(pca_2)
PVE_2 <- (pca_2$sdev**2) / sum(pca_2$sdev**2)
PVE[1]+PVE[2]
plot(pca_2$x[,1],pca_2$x[,2])
View(above.4_Table)
identical(above.4_Table$CONTEXT, above.4_Table$EnsVar_most_severe_consequence)
unique(above.4_Table$CONTEXT)
unique(above.4_Table$EnsVar_most_severe_consequence)
library(ggplot2)
print(p1)
p1 <- ggplot(mtcars, aes(x = mpg, y = wt)) + geom_point()
print(p1)
pca_2gg <- ggplot(pca_2, aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()
pca_2gg <- ggplot(aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()
pca_2gg <- ggplot(pca_2$x, aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()
print(p1)
print(pca_2gg)
View(pca_2)
pop_labels <- rownames(fstPopAbove.4_perVar)
pop_labels <- colnames(fstPopAbove.4_perVar)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)
print(pca_2gg)
print(pca_2gg)
print(pca_2gg)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")
print(pca_2gg)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+title("PCA on Variants above 0.4 Fst")
print(pca_2gg)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+title("PCA on Variants above 0.4 Fst")
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+ggtitle("PCA on Variants above 0.4 Fst")
print(pca_2gg)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text(aes(label=pop_labels))
print(pca_2gg)
?geom_text
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text(aes(label=pop_labels), vjust=1, hjust=1)
print(pca_2gg)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text(aes(label=pop_labels), vjust=1, hjust=1, size=2)
print(pca_2gg)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)
print(pca_2gg)
# want to fix overlapping:
install.packages("ggrepel")
library(ggrepel)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("Principle Component 1")+
ylab("Principle Component 2")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)
print(pca_2gg)
head(pops)
pop_labels
View(pops)
superPops <- data.frame(c("ACB", "AFR", "AMR", "ASW", "BEB", "CDX", "CEU", "CHB", "CHS", "CLM", "EAS", "ESN", "EUR", "FIN", "GBR", "GIH", "GWD", "IBS", "ITU", "JPT", "KHV", "LWK", "MSL", "MXL", "PEL", "PJL", "PUR", "SAS", "STU", "TSI", "YRI"), c("African", "African", "AdmixedAmerican","African","SouthAsian","EastAsian","European", "EastAsian", "EastAsian", "AdmixedAmerican","EastAsian", "African", "European", "European", "European", "SouthAsian", "African", "European", "SouthAsian", "EastAsian", "EastAsian","African", "African", 'AdmixedAmerican','AdmixedAmerican', "SouthAsian", 'AdmixedAmerican', "SouthAsian","SouthAsian", "European", "African"))
View(superPops)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("First Principle Component")+
ylab("Second Principle Component")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)
print(pca_2gg)
legend_labs <- pops[ 1:32,c(1,4)]
legend_labs
legend_labs <- pops[ 2:32,c(1,4)]
legend_labs$Population_Abbreviation <- gsub("1000GENOMES:phase_3:",'',legend_labs$Population_Abbreviation)
legend_labs
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("First Principle Component")+
ylab("Second Principle Component")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
legend(legend_labs)
pca_2gg <- ggplot(as.data.frame(pca_2$x), aes(x = pca_2$x[,1], y = pca_2$x[,2]))+geom_point()+labs(pop_labels)+xlab("First Principle Component")+
ylab("Second Principle Component")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
legend(x = legend_labs$Population_Abbreviation, y = legend_labs$PopAnces_Graph_Labels)
View(fstPopAbove.4_perVar)
length(pca_2$x[,1])
pca_2_DF <- data.frame(pca_2$x[,1], pca_2$x[,2], superPops)
View(pca_2_DF)
pca_2$x[,1][1:2]
colnames(pca_2_DF) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_2DFgg <- ggplot(pca_2_DF, aes(x = pca_2_DF$`First Principal Component`, y = pca_2_DF$`Second Principal Component`, color = pca_2_DF$`Super Population`))+geom_point()+labs(pca_2_DF$`Population Abbrevation`)+xlab("First Principle Component")+
ylab("Second Principle Component")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
legend(x = legend_labs$Population_Abbreviation, y = legend_labs$PopAnces_Graph_Labels)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = pca_2_DF$`First Principal Component`, y = pca_2_DF$`Second Principal Component`, color = pca_2_DF$`Super Population`))+geom_point()+labs(pca_2_DF$`Population Abbrevation`)+xlab("First Principle Component")+
ylab("Second Principle Component")+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)
print(pca_2gg)
?ggplot
?aes
?scale_color_manual
pca_2DFgg <- ggplot(pca_2_DF, aes(x = pca_2_DF$`First Principal Component`, y = pca_2_DF$`Second Principal Component`))+geom_point()
pca_2DFgg <- ggplot(pca_2_DF, aes(x = pca_2_DF$`First Principal Component`, y = pca_2_DF$`Second Principal Component`, fill=pca_2_DF$`Super Population`))
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = pca_2_DF$`First Principal Component`, y = pca_2_DF$`Second Principal Component`, fill=pca_2_DF$`Super Population`))
print(pca_2gg)
install.packages(esquisse)
install.packages('esquisse')
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, color=`Super Population`))
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, color=`Super Population`))
print(pca_2gg)
library(esquisse)
esquisser(pca_2_DF)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, color=`Super Population`))
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))
print(pca_2gg)
+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+scale_color_hue(direction = 1)
+ggtitle("PCA on Variants above 0.4 Fst")+geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF) +
aes(x = `First Principal Component`,y = `Second Principal Component`,colour = `Super Population`) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_minimal()
print(pca_2gg)
pca_2DFgg <- ggplot(pca_2_DF) +
aes(x = `First Principal Component`,y = `Second Principal Component`,colour = `Super Population`) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_minimal()
print(pca_2gg)
pca_2DFgg2 <- ggplot(pca_2_DF) +
aes(x = `First Principal Component`,y = `Second Principal Component`,colour = `Super Population`) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_minimal()
print(pca_2gg)
print(pca_2gg2)
print(pca_2gg2)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))
print(pca_2DFgg)
pca_2DFgg2 <- ggplot(pca_2_DF) +
aes(x = `First Principal Component`,y = `Second Principal Component`,colour = `Super Population`) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_minimal()
print(pca_2DFgg2)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))
print(pca_2DFgg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point()+
labs(pca_2_DF$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal()
print(pca_2DFgg)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_2_DF$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal()
print(pca_2DFgg)
popAbrvLegend <- pops[2:32, c(1,4)]
legend_labs
?ggsave
ggsave('PCA_allSubPopsVSmetaPop_withSuperPopulationColor', scale = 3)
rlang::last_error()
ggsave(filename = 'PCA_allSubPopsVSmetaPop_withSuperPopulationColor', scale = 3)
ggsave(filename = 'PCA_allSubPopsVSmetaPop_withSuperPopulationColor.png', scale = 3)
pca_2DFgg <- ggplot(pca_2_DF, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_2_DF$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_2DFgg)
ggsave(filename = 'PCA_allSubPopsVSmetaPop_withSuperPopulationColor.PNG', scale = 3)
View(above.4_Table)
colnames(above.4_Table)
unique(above.4_Table$`Parent term`)
View(allFst_allPops_list_topTables)
View(allDiseaseSNPfst_topTables)
View(allFst_allPops_list)
View(allFst_popsVSall)
View(comp_top1_above.4)
View(dfpvInspect)
View(L_diseaseFst_popsVSall_topSnps)
View(L_diseaseFst_popsVSall)
View(diseaseFst_popsVSall)
View(full_fst_fixed)
uniDiseaseSNPs
View(SNPannoTable_disease)
diseaseParentTerms
above.4_T_diseaseOnly <- above.4_Table[above.4_Table$`Parent term` %in% diseaseParentTerms,]
# check that all SNPs we expect to see remain:
uni.4_names[1:10]
length(uni.4_names)
sum(uni.4_names %in% above.4_T_diseaseOnly$VariantID)
?split
parentTermsTable <- split(above.4_T_diseaseOnly, above.4_T_diseaseOnly$`Parent term`)
View(parentTermsTable)
sapply(parentTermsTable, length)
sapply(parentTermsTable, nrow)
View(fstPopAbove.4_perVar)
rownames(parentTermsTable$Cancer)
names(parentTermsTable$Cancer)
parentTermsTable$Cancer$VariantID
cancerFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$Cancer$VariantID ,]
View(cancerFst)
parentTermsTable[["Cancer"]][["VariantID"]]
pca_Cancer <- prcomp(t(cancerFst))
PVE_Cancer <- (pca_Cancer$sdev**2) / sum(pca_Cancer$sdev**2)
PVE_Cancer[1]+PVE_Cancer[2] # 0.5482454 ... exactly the same, BUT most of it is contained within the first component now. I am sure Dr. Scheild would like to explain why... I would like to know.
plot(pca_Cancer$x[,1],pca_Cancer$x[,2])
pca_DF_cancer <- data.frame(pca_Cancer$x[,1], pca_Cancer$x[,2], superPops)
pca_Cancer$x[,1]
superPops
colnames(pca_Cancer_DF) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
colnames(pca_DF_cancer) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_CancerDFgg <- ggplot(pca_DF_cancer, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_cancer$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_CancerDFgg)
pca_CancerDFgg <- ggplot(pca_DF_cancer, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_cancer$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Cancer - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_CancerDFgg)
cardiovascular_diseaseFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$`Cardiovascular disease`$VariantID ,]
pca_cardiovascular_disease <- prcomp(t(cardiovascular_diseaseFst))
PVE_cardiovascular_disease <- (pca_cardiovascular_disease$sdev**2) / sum(pca_cardiovascular_disease$sdev**2)
PVE_cardiovascular_disease[1]+PVE_cardiovascular_disease[2] # 0.6789227
plot(pca_cardiovascular_disease$x[,1],pca_cardiovascular_disease$x[,2])
pca_DF_cardiovascular_disease <- data.frame(pca_cardiovascular_disease$x[,1], pca_cardiovascular_disease$x[,2], superPops)
colnames(pca_DF_cardiovascular_disease) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_cardiovascular_diseaseDFgg <- ggplot(pca_DF_cardiovascular_disease, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_cardiovascular_disease$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Cardiovascular Disease - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_cardiovascular_diseaseDFgg)
digestive_disorderFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$`Digestive system disorder`$VariantID ,]
pca_digestive_disorder <- prcomp(t(digestive_disorderFst))
PVE_digestive_disorder <- (pca_digestive_disorder$sdev**2) / sum(pca_digestive_disorder$sdev**2)
PVE_digestive_disorder[1]+PVE_digestive_disorder[2] # 0.7501739
plot(pca_digestive_disorder$x[,1],pca_digestive_disorder$x[,2])
pca_DF_digestive_disorder <- data.frame(pca_digestive_disorder$x[,1], pca_digestive_disorder$x[,2], superPops)
colnames(pca_DF_digestive_disorder) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_digestive_disorderDFgg <- ggplot(pca_DF_digestive_disorder, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_digestive_disorder$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Digestive System Disorder - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_digestive_disorderDFgg)
# num unique SNPS per term
sapply(parentTermsTable, \(x){length(unique(x$VariantID))})
immune_disorderFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$`Immune system disorder`$VariantID ,]
pca_immune_disorder <- prcomp(t(immune_disorderFst))
PVE_immune_disorder <- (pca_immune_disorder$sdev**2) / sum(pca_immune_disorder$sdev**2)
PVE_immune_disorder[1]+PVE_immune_disorder[2] # 0.7501739
plot(pca_immune_disorder$x[,1],pca_immune_disorder$x[,2])
pca_DF_immune_disorder <- data.frame(pca_immune_disorder$x[,1], pca_immune_disorder$x[,2], superPops)
colnames(pca_DF_immune_disorder) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_immune_disorderDFgg <- ggplot(pca_DF_immune_disorder, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_immune_disorder$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Immune System Disorder - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_immune_disorderDFgg)
metabolic_disorderFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$`Metabolic disorder`$VariantID ,]
pca_metabolic_disorder <- prcomp(t(metabolic_disorderFst))
PVE_metabolic_disorder <- (pca_metabolic_disorder$sdev**2) / sum(pca_metabolic_disorder$sdev**2)
PVE_metabolic_disorder[1]+PVE_metabolic_disorder[2] # 0.7501739
plot(pca_metabolic_disorder$x[,1],pca_metabolic_disorder$x[,2])
pca_DF_metabolic_disorder <- data.frame(pca_metabolic_disorder$x[,1], pca_metabolic_disorder$x[,2], superPops)
colnames(pca_DF_metabolic_disorder) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_metabolic_disorderDFgg <- ggplot(pca_DF_metabolic_disorder, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_metabolic_disorder$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Metabolic Disorder - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_metabolic_disorderDFgg)
neurological_disorderFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$`Neurological disorder`$VariantID ,]
pca_neurological_disorder <- prcomp(t(neurological_disorderFst))
PVE_neurological_disorder <- (pca_neurological_disorder$sdev**2) / sum(pca_neurological_disorder$sdev**2)
PVE_neurological_disorder[1]+PVE_neurological_disorder[2] # 0.7501739
plot(pca_neurological_disorder$x[,1],pca_neurological_disorder$x[,2])
pca_DF_neurological_disorder <- data.frame(pca_neurological_disorder$x[,1], pca_neurological_disorder$x[,2], superPops)
colnames(pca_DF_neurological_disorder) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_neurological_disorderDFgg <- ggplot(pca_DF_neurological_disorder, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_neurological_disorder$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Neurological Disorder - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_neurological_disorderDFgg)
other_diseaseFst <- fstPopAbove.4_perVar[rownames(fstPopAbove.4_perVar) %in% parentTermsTable$`Other disease`$VariantID ,]
pca_other_disease <- prcomp(t(other_diseaseFst))
PVE_other_disease <- (pca_other_disease$sdev**2) / sum(pca_other_disease$sdev**2)
PVE_other_disease[1]+PVE_other_disease[2] # 0.7501739
plot(pca_other_disease$x[,1],pca_other_disease$x[,2])
pca_DF_other_disease <- data.frame(pca_other_disease$x[,1], pca_other_disease$x[,2], superPops)
colnames(pca_DF_other_disease) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_other_diseaseDFgg <- ggplot(pca_DF_other_disease, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_other_disease$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("Other Disease - PCA on Variants above 0.4 Fst")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_other_diseaseDFgg)
legend_labs
nrow(fstPopAbove.4_perVar)
6287/365
View(diseaseFst_popsVSall)
colnames(diseaseFst_popsVSall) <- gsub('1000GENOMES:phase_3:','',gsub('1000GENOMES:phase_3:ALL','',gsub('-X-','',colnames(diseaseFst_popsVSall))))
colnames(diseaseFst_popsVSall)
pca_all_variants <- prcomp(t(diseaseFst_popsVSall))
PVE_all_variants <- (pca_all_variants$sdev**2) / sum(pca_all_variants$sdev**2)
PVE_all_variants[1]+PVE_all_variants[2] # 0.718618
plot(pca_all_variants$x[,1],pca_all_variants$x[,2])
pca_DF_all_variants <- data.frame(pca_all_variants$x[,1], pca_all_variants$x[,2], superPops)
colnames(pca_DF_all_variants) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_all_variantsDFgg <- ggplot(pca_DF_all_variants, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_all_variants$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on All Variants")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_all_variantsDFgg)
pca_all_variantsDFgg <- ggplot(pca_DF_all_variants, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_all_variants$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on All Disease Variants")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_all_variantsDFgg)
View(allFst_popsVSall)
colnames(allFst_popsVSall) <- gsub('1000GENOMES:phase_3:','',gsub('1000GENOMES:phase_3:ALL','',gsub('-X-','',colnames(allFst_popsVSall))))
pca_all_variants_ALL <- prcomp(t(allFst_popsVSall))
PVE_all_variants_ALL <- (pca_all_variants_ALL$sdev**2) / sum(pca_all_variants_ALL$sdev**2)
PVE_all_variants_ALL[1]+PVE_all_variants_ALL[2] # 0.5696698 .. as expected, less variance is explained when there is more data.. tougher to reduce the data meaningfully
plot(pca_all_variants_ALL$x[,1],pca_all_variants_ALL$x[,2])
pca_DF_all_variants_ALL <- data.frame(pca_all_variants_ALL$x[,1], pca_all_variants_ALL$x[,2], superPops)
colnames(pca_DF_all_variants_ALL) <- c("First Principal Component", "Second Principal Component", "Population Abbrevation", "Super Population")
pca_all_variants_ALLDFgg <- ggplot(pca_DF_all_variants_ALL, aes(x = `First Principal Component`, y = `Second Principal Component`, colour=`Super Population`))+
geom_point(shape = "circle", size = 2)+
labs(pca_DF_all_variants_ALL$`Population Abbrevation`)+
xlab("First Principle Component")+
ylab("Second Principle Component")+
ggtitle("PCA on All Variants")+
geom_text_repel(aes(label=pop_labels), vjust=1, hjust=1, size=3.5)+
scale_color_hue(direction = 1)+
theme_minimal(base_size = 14)
print(pca_all_variants_ALLDFgg)
pca_all_variants_ALL <- prcomp(allFst_popsVSall)
PVE_all_variants_ALL <- (pca_all_variants_ALL$sdev**2) / sum(pca_all_variants_ALL$sdev**2)
PVE_all_variants_ALL[1]+PVE_all_variants_ALL[2] # 0.5797212
plot(pca_all_variants_ALL$x[,1],pca_all_variants_ALL$x[,2])
load("./workingData/subTraitsList.rds")
View(testSave)
